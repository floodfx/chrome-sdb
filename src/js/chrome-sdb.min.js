(function(){var SHA1;
SHA1=function(){var f,a,b,d,e,c,k,l,p,o,m,t,v,r;d={};o=function(h){return f(a(k(h),h.length*8))};p=function(h,i){var j,g,q,n;j=k(h);if(j.length>16)j=a(j,h.length*8);q=Array(16);n=Array(16);for(g=0;g<16;g++){q[g]=j[g]^909522486;n[g]=j[g]^1549556828}j=a(q.concat(k(i)),512+i.length*8);return f(a(n.concat(j),672))};l=function(h,i){var j,g,q,n,s;if(i==null)i=true;j=i?"0123456789abcdef":"0123456789ABCDEF";q="";g=0;for(s=h.length;0<=s?g<s:g>s;0<=s?g++:g--){n=h.charCodeAt(g);q+=j.charAt(n>>>4&15)+j.charAt(n&
15)}return q};c=function(h,i){var j,g,q,n,s;if(i==null)i="=";n="";q=h.length;for(j=0;j<q;j+=3){s=h.charCodeAt(j)<<16|(j+1<q?h.charCodeAt(j+1)<<8:0)|(j+2<q?h.charCodeAt(j+2):0);for(g=0;g<4;g++)n+=j*8+g*6>h.length*8?i:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>>6*(3-g)&63)}return n};e=function(h,i){var j,g,q,n,s,w,u,x;g=i.length;q=[];j=Array(Math.ceil(h.length/2));n=0;for(s=j.length;0<=s?n<s:n>s;0<=s?n++:n--)j[n]=h.charCodeAt(n*2)<<8|h.charCodeAt(n*2+1);for(;j.length>
0;){w=[];n=u=0;for(x=j.length;0<=x?n<x:n>x;0<=x?n++:n--){u=(u<<16)+j[n];s=Math.floor(u/g);u-=s*g;if(w.length>0||s>0)w[w.length]=s}q[q.length]=u;j=w}j="";for(n=g=q.length-1;g<=0?n<=0:n>=0;g<=0?n++:n--)j+=i.charAt(q[n]);q=Math.ceil(h.length*8/(Math.log(i.length)/Math.log(2)));for(n=g=j.length;g<=q?n<=q:n>=q;g<=q?n++:n--)j=i[0]+j;return j};r=function(h){var i,j,g,q,n;j="";i=0;for(n=h.length;0<=n?i<n:i>n;0<=n?i++:i--){g=h.charCodeAt(i);q=i+1<h.length?h.charCodeAt(i+1):0;if(55296<=g&&g<=56319&&56320<=
q&&q<=57343){g=65536+((g&1023)<<10)+(q&1023);i++}if(g<=127)j+=String.fromCharCode(g);else if(g<=2047)j+=String.fromCharCode(192|g>>>6&31,128|g&63);else if(g<=65535)j+=String.fromCharCode(224|g>>>12&15,128|g>>>6&63,128|g&63);else if(g<=2097151)j+=String.fromCharCode(240|g>>>18&7,128|g>>>12&63,128|g>>>6&63,128|g&63)}return j};k=function(h){var i,j,g;j=Array(h.length>>2);i=0;for(g=j.length;0<=g?i<g:i>g;0<=g?i++:i--)j[i]=0;i=0;for(g=h.length*8;i<g;i+=8)j[i>>5]|=(h.charCodeAt(i/8)&255)<<24-i%32;return j};
f=function(h){var i,j,g;j="";i=0;for(g=h.length*32;i<g;i+=8)j+=String.fromCharCode(h[i>>5]>>>24-i%32&255);return j};a=function(h,i){var j,g,q,n,s,w,u,x,z,A,B,C,D,y,E;h[i>>5]|=128<<24-i%32;h[(i+64>>9<<4)+15]=i;y=Array(80);j=1732584193;g=-271733879;q=-1732584194;n=271733878;s=-1009589776;w=0;for(E=h.length;w<E;w+=16){x=j;z=g;A=q;B=n;C=s;for(u=0;u<80;u++){y[u]=u<16?h[w+u]:b(y[u-3]^y[u-8]^y[u-14]^y[u-16],1);D=m(m(b(j,5),t(u,g,q,n)),m(m(s,y[u]),v(u)));s=n;n=q;q=b(g,30);g=j;j=D}j=m(j,x);g=m(g,z);q=m(q,
A);n=m(n,B);s=m(s,C)}return Array(j,g,q,n,s)};t=function(h,i,j,g){return h<20?i&j|~i&g:h<40?i^j^g:h<60?i&j|i&g|j&g:i^j^g};v=function(h){return h<20?1518500249:h<40?1859775393:h<60?-1894007588:-899497514};m=function(h,i){var j;j=(h&65535)+(i&65535);return(h>>16)+(i>>16)+(j>>16)<<16|j&65535};b=function(h,i){return h<<i|h>>>32-i};d.hex_sha1=function(h){return l(o(r(h)))};d.b64_sha1=function(h){return c(o(r(h)))};d.any_sha1=function(h,i){return e(o(r(h)),i)};d.hex_hmac_sha1=function(h,i){return l(p(r(h),
r(i)))};d.b64_hmac_sha1=function(h,i){return c(p(r(h),r(i)))};d.any_hmac_sha1=function(h,i,j){return e(p(r(h),r(i)),j)};return d}();var Storage;Storage=function(){var f;f={};f.get=function(a,b){var d;if(b==null)b=false;d=localStorage.getItem(a);if(b)d=JSON.parse(d);return d};f.set=function(a,b,d){if(d==null)d=false;if(d)b=JSON.stringify(b);localStorage.setItem(a,b);return b};f.del=function(a){return localStorage.removeItem(a)};return f}();var Settings;
Settings=function(){function f(a,b,d,e){this.access_key=a;this.secret_key=b;this.region=d!=null?d:"us-east-1";this.version=e!=null?e:"2009-04-15"}f.prototype.use_access_key=function(a){this.access_key=a;return this};f.prototype.use_secret_key=function(a){this.secret_key=a;return this};f.prototype.use_region=function(a){this.region=a;return this};f.prototype.use_version=function(a){this.version=a;return this};f.prototype.get_access_key=function(){return this.access_key};f.prototype.get_secret_key=
function(){return this.secret_key};f.prototype.get_region=function(){return this.region};f.prototype.get_version=function(){return this.version};f.prototype.to_json=function(){return{access_key:this.access_key,secret_key:this.secret_key,region:this.region,version:this.version}};f.from_json=function(a){return a?new f(a.access_key,a.secret_key,a.region,a.version):null};return f}();var AwsUtils;
AwsUtils=function(){var f,a,b,d,e;e=function(c){c=c.toString();if(c.length<2)c="0"+c;return c};d=function(c){return[c.getUTCFullYear(),e(c.getUTCMonth()+1),e(c.getUTCDate())].join("-")};f=function(c){return[e(c.getUTCHours()),e(c.getUTCMinutes()),e(c.getUTCSeconds())].join(":")};b=function(c,k){return c===k?0:c.toLowerCase()>k.toLowerCase()?1:-1};a={};a.date_time_format=function(c){if(c==null)c=new Date;return""+d(c)+"T"+f(c)+".000Z"};a.generate_sig=function(c,k){var l,p,o;p=function(){var m;m=[];
for(l in c)m.push(l);return m}();p.sort(b);o=function(){var m,t,v;v=[];m=0;for(t=p.length;m<t;m++){l=p[m];v.push(""+l+c[l])}return v}();return SHA1.b64_hmac_sha1(k,o.join(""))};return a}();var SimpleDB,__indexOf=Array.prototype.indexOf||function(f){for(var a=0,b=this.length;a<b;a++)if(this[a]===f)return a;return-1};
SimpleDB=function(){function f(a,b){this.profile=a;this.endpoint=b!=null?b:"sdb.amazonaws.com";this.sdb_base_url="http://"+this.endpoint+"?"}f.prototype.set_profile=function(a){return this.profile=a};f.prototype.default_callback=function(a){return console.log(a)};f.prototype.build_request_url=function(a,b){var d,e;b.Action=a;b.Timestamp=AwsUtils.date_time_format();b.AWSAccessKeyId=this.profile.get_settings().get_access_key();b.Version=this.profile.get_settings().get_version();b.SignatureVersion=1;
b.Signature=AwsUtils.generate_sig(b,this.profile.get_settings().get_secret_key());return this.sdb_base_url+function(){var c;c=[];for(d in b){e=b[d];c.push(d+"="+encodeURIComponent(e))}return c}().join("&")};f.parse_metadata=function(a,b,d){return{meta:{req_id:$("RequestId",a).text(),box_usage:parseFloat($("BoxUsage",a).text()),status:b,req_url:d}}};f.prototype.ajax_request=function(a,b,d,e){if(d==null)d="GET";if(e==null)e=b;return $.ajax({type:d,url:a,success:function(c,k){return b(f.parse_metadata(c,
k,a),c)},error:function(c,k){var l;l=f.parse_metadata(c.responseXML,k,a);l.error={msg:$("Message",c.responseXML).text(),code:$("Code",c.responseXML).text()};return e(l,c.responseXML)},dataType:"xml"})};f.prototype.list_domains=function(a,b,d){var e,c;if(a==null)a=this.default_callback;if(b==null)b=100;if(d==null)d=null;if(__indexOf.call(function(){c=[];for(e=1;e<=100;e++)c.push(e);return c}.apply(this),b)<0)throw"Max domains must be between 1 and 100";b={MaxNumberOfDomains:b};if(d)b.NextToken=d;return this.ajax_request(this.build_request_url("ListDomains",
b),function(k,l){var p;k.error!=null&&a(k);p=[];$("DomainName",l).each(function(){return p.push($(this).text())});k.domains=p;k.next_token=$("NextToken",l).text();return a(k)})};f.prototype.domain_metadata=function(a,b){if(b==null)b=this.default_callback;return this.ajax_request(this.build_request_url("DomainMetadata",{DomainName:a}),function(d,e){d.error!=null&&b(d);d.creation_date_time=$("CreationDateTime",e).text();d.item_count=parseInt($("ItemCount",e).text());d.item_names_size_bytes=parseInt($("ItemNamesSizeBytes",
e).text());d.attribute_name_count=parseInt($("AttributeNameCount",e).text());d.attribute_names_size_bytes=parseInt($("AttributeNamesSizeBytes",e).text());d.attribute_value_count=parseInt($("AttributeValueCount",e).text());d.attribute_values_size_bytes=parseInt($("AttributeValuesSizeBytes",e).text());d.timestamp=$("Timestamp",e).text();return b(d)})};f.prototype.select=function(a,b,d){if(b==null)b=this.default_callback;if(d==null)d=null;a={SelectExpression:a};if(d)a.NextToken=d;return this.ajax_request(this.build_request_url("Select",
a),function(e,c){var k,l,p;e.error!=null&&b(e);p=[];l={};$("Item",c).each(function(){var o;o={attrs:{},name:$("Name:first",$(this)).text()};$("Attribute",$(this)).each(function(){var m,t;m=$("Name",$(this)).text();l[m]=m;t=$("Value",$(this)).text();o.attrs[m]||(o.attrs[m]=[]);return o.attrs[m].push(t)});return p.push(o)});e.items=p;e.attr_names=function(){var o;o=[];for(k in l)o.push(k);return o}();e.next_token=$("NextToken",c).text();return b(e)})};f.prototype.get_attributes=function(a,b,d,e){var c;
if(d==null)d=this.default_callback;if(e==null)e=[];b={DomainName:a,ItemName:b};a=0;for(c=e.length;0<=c?a<c:a>c;0<=c?a++:a--)b["AttributeName."+a]=e[a];return this.ajax_request(this.build_request_url("GetAttributes",b),function(k,l){var p;k.error!=null&&d(k);p={};$("Attribute",l).each(function(){var o,m;o=$("Name",$(this)).text();m=$("Value",$(this)).text();p[o]||(p[o]=[]);return p[o].push(m)});k.attributes=p;return d(k)})};f.prototype.put_attributes=function(a,b,d,e){var c,k,l,p,o,m,t;if(e==null)e=
this.default_callback;k={DomainName:a,ItemName:b};p=b=0;for(m=d.length;p<m;p++){a=d[p];c=a.values;o=0;for(t=c.length;o<t;o++){l=c[o];k["Attribute."+b+".Name"]=a.name;k["Attribute."+b+".Value"]=l;if(a.replace&&a.replace===true)k["Attribute."+b+".Replace"]=true;b+=1}}return this.ajax_request(this.build_request_url("PutAttributes",k),function(v){return e(v)})};f.prototype.delete_attributes=function(a,b,d,e){var c,k,l,p,o,m,t;if(e==null)e=this.default_callback;k={DomainName:a,ItemName:b};p=b=0;for(m=
d.length;p<m;p++){a=d[p];if(c=a.values){o=0;for(t=c.length;o<t;o++){l=c[o];k["Attribute."+b+".Name"]=a.name;k["Attribute."+b+".Value"]=l;b+=1}}else{k["Attribute."+b+".Name"]=a.name;b+=1}}return this.ajax_request(this.build_request_url("DeleteAttributes",k),function(v){return e(v)})};f.prototype.batch_delete_attributes=function(a,b,d){var e,c,k,l,p,o,m,t,v,r,h;if(d==null)d=this.default_callback;l={DomainName:a};a=0;for(r=b.length;0<=r?a<r:a>r;0<=r?a++:a--){e=b[a];c=e.item_name;l["Item."+a+".ItemName"]=
c;c=0;h=e.item_attrs;o=0;for(t=h.length;o<t;o++){e=h[o];if(k=e.values){m=0;for(v=k.length;m<v;m++){p=k[m];l["Item."+a+".Attribute."+c+".Name"]=e.name;l["Item."+a+".Attribute."+c+".Value"]=p;c+=1}}else{l["Item."+a+".Attribute."+c+".Name"]=e.name;c+=1}}}return this.ajax_request(this.build_request_url("BatchDeleteAttributes",l),function(i){return d(i)})};f.prototype.batch_put_attributes=function(a,b,d){var e,c,k,l,p,o,m,t,v,r,h;if(d==null)d=this.default_callback;l={DomainName:a};a=0;for(r=b.length;0<=
r?a<r:a>r;0<=r?a++:a--){e=b[a];c=e.item_name;l["Item."+a+".ItemName"]=c;c=0;h=e.item_attrs;o=0;for(t=h.length;o<t;o++){e=h[o];k=e.values;m=0;for(v=k.length;m<v;m++){p=k[m];l["Item."+a+".Attribute."+c+".Name"]=e.name;l["Item."+a+".Attribute."+c+".Value"]=p;if(e.replace&&e.replace===true)l["Item."+a+".Attribute."+c+".Replace"]=true;c+=1}}}return this.ajax_request(this.build_request_url("BatchPutAttributes",l),function(i){return d(i)})};f.prototype.create_domain=function(a,b){if(b==null)b=this.default_callback;
return this.ajax_request(this.build_request_url("CreateDomain",{DomainName:a}),function(d){return b(d)})};f.prototype.delete_domain=function(a,b){if(b==null)b=this.default_callback;return this.ajax_request(this.build_request_url("DeleteDomain",{DomainName:a}),function(d){return b(d)})};return f}();var Profile;
Profile=function(){function f(a,b){this.name=a;this.settings=b}f.prototype.use_name=function(a){this.name=a;return this};f.prototype.use_settings=function(a){this.settings=a;return this};f.prototype.get_name=function(){return this.name};f.prototype.get_settings=function(){return this.settings};f.prototype.make_primary=function(){Storage.set("chrome-sdb.primary-profile",this.name);return this};f.prototype.save=function(a){var b,d,e,c,k;if(a==null)a=false;e=f.find_all();b=false;c=0;for(k=e.length;c<
k;c++){d=e[c];if(this.name===d.get_name()){d.use_settings(this.settings);b=true}}b||e.push(this);Storage.set("chrome-sdb.profiles",f.profiles_json(e),true);if(f.primary()===null||a)this.make_primary();return this};f.prototype["delete"]=function(){f["delete"](this.name);return null};f.prototype.to_json=function(){return{name:this.name,settings:this.settings.to_json()}};f.primary=function(){var a;a=Storage.get("chrome-sdb.primary-profile");return f.find(a)};f.from_json=function(a){return a?new f(a.name,
Settings.from_json(a.settings)):null};f.find_all=function(){var a,b,d,e;b=(e=Storage.get("chrome-sdb.profiles",true))!=null?e:{};return function(){var c;c=[];for(a in b){d=b[a];c.push(new f(a,Settings.from_json(d)))}return c}()};f.find=function(a){var b,d,e,c;d=f.find_all();e=0;for(c=d.length;e<c;e++){b=d[e];if(b.get_name()===a)return b}return null};f.profiles_json=function(a){var b,d,e,c;d={};e=0;for(c=a.length;e<c;e++){b=a[e];d[b.get_name()]=b.get_settings().to_json()}return d};f.delete_all=function(){return Storage.set("chrome-sdb.profiles",
{},true)};f["delete"]=function(a){var b,d,e,c;e=f.find_all();d=[];b=0;for(c=e.length;0<=c?b<c:b>c;0<=c?b++:b--)e[b].get_name()!==a&&d.push(e[b]);return Storage.set("chrome-sdb.profiles",f.profiles_json(d),true)};return f}();var handle_domains,handle_query,profile,query,sdb;(profile=Profile.primary())||chrome.tabs.create({url:"config.html"});handle_domains=function(){};sdb=new SimpleDB(profile);
sdb.list_domains(function(f){var a,b,d,e;b=f.domains;e=function(){var c,k,l;l=[];c=0;for(k=b.length;c<k;c++){a=b[c];d='<a id="metadata_'+a+'" class="btn" href="#">Metadata</a>';l.push("<tr><td>"+a+"</td><td>"+d+"</td></tr>")}return l}();return $(function(){return $("#domains_table > tbody").html(e.join(""))})});
handle_query=function(f){var a,b,d,e,c,k;console.log(f);if(f.items.length===0)return $("#query_results_table > tbody").html("No results...");else{c=function(){var l,p,o,m;o=f.attr_names;m=[];l=0;for(p=o.length;l<p;l++){a=o[l];m.push("<th>"+a+"</th>")}return m}();k=function(){var l,p,o,m;o=f.items;m=[];l=0;for(p=o.length;l<p;l++){d=o[l];console.log(d.name);e=function(){var t,v,r,h;r=f.attr_names;h=[];t=0;for(v=r.length;t<v;t++){a=r[t];b=d.attrs[a];console.log(b);h.push(b!=null?b.length>1?"<td><table><tbody><tr><td>"+
b.join("</td><td>")+"</td></tr></tbody></table></td>":"<td>"+b.join("")+"</td>":"<td></td>")}return h}();m.push("<tr><td>"+d.name+"</td>"+e.join("")+"</tr>")}return m}();$("#query_results_table > thead").html("<tr><th>Item Name</th>"+c.join("")+"</tr>");return $("#query_results_table > tbody").html(k.join(""))}};query=function(){var f;f=$("#query_expr").val();console.log(f);return sdb.select(f,handle_query)};})();
