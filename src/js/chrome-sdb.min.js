(function(){var SHA1;
SHA1=function(){var i,a,b,c,e,d,l,m,n,q,o,u,v,s;c={};q=function(j){return i(a(l(j),j.length*8))};n=function(j,g){var h,f,p,k;h=l(j);if(h.length>16)h=a(h,j.length*8);p=Array(16);k=Array(16);for(f=0;f<16;f++){p[f]=h[f]^909522486;k[f]=h[f]^1549556828}h=a(p.concat(l(g)),512+g.length*8);return i(a(k.concat(h),672))};m=function(j,g){var h,f,p,k,r;if(g==null)g=true;h=g?"0123456789abcdef":"0123456789ABCDEF";p="";f=0;for(r=j.length;0<=r?f<r:f>r;0<=r?f++:f--){k=j.charCodeAt(f);p+=h.charAt(k>>>4&15)+h.charAt(k&
15)}return p};d=function(j,g){var h,f,p,k,r;if(g==null)g="=";k="";p=j.length;for(h=0;h<p;h+=3){r=j.charCodeAt(h)<<16|(h+1<p?j.charCodeAt(h+1)<<8:0)|(h+2<p?j.charCodeAt(h+2):0);for(f=0;f<4;f++)k+=h*8+f*6>j.length*8?g:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>6*(3-f)&63)}return k};e=function(j,g){var h,f,p,k,r,w,t,x;f=g.length;p=[];h=Array(Math.ceil(j.length/2));k=0;for(r=h.length;0<=r?k<r:k>r;0<=r?k++:k--)h[k]=j.charCodeAt(k*2)<<8|j.charCodeAt(k*2+1);for(;h.length>
0;){w=[];k=t=0;for(x=h.length;0<=x?k<x:k>x;0<=x?k++:k--){t=(t<<16)+h[k];r=Math.floor(t/f);t-=r*f;if(w.length>0||r>0)w[w.length]=r}p[p.length]=t;h=w}h="";for(k=f=p.length-1;f<=0?k<=0:k>=0;f<=0?k++:k--)h+=g.charAt(p[k]);p=Math.ceil(j.length*8/(Math.log(g.length)/Math.log(2)));for(k=f=h.length;f<=p?k<=p:k>=p;f<=p?k++:k--)h=g[0]+h;return h};s=function(j){var g,h,f,p,k;h="";g=0;for(k=j.length;0<=k?g<k:g>k;0<=k?g++:g--){f=j.charCodeAt(g);p=g+1<j.length?j.charCodeAt(g+1):0;if(55296<=f&&f<=56319&&56320<=
p&&p<=57343){f=65536+((f&1023)<<10)+(p&1023);g++}if(f<=127)h+=String.fromCharCode(f);else if(f<=2047)h+=String.fromCharCode(192|f>>>6&31,128|f&63);else if(f<=65535)h+=String.fromCharCode(224|f>>>12&15,128|f>>>6&63,128|f&63);else if(f<=2097151)h+=String.fromCharCode(240|f>>>18&7,128|f>>>12&63,128|f>>>6&63,128|f&63)}return h};l=function(j){var g,h,f;h=Array(j.length>>2);g=0;for(f=h.length;0<=f?g<f:g>f;0<=f?g++:g--)h[g]=0;g=0;for(f=j.length*8;g<f;g+=8)h[g>>5]|=(j.charCodeAt(g/8)&255)<<24-g%32;return h};
i=function(j){var g,h,f;h="";g=0;for(f=j.length*32;g<f;g+=8)h+=String.fromCharCode(j[g>>5]>>>24-g%32&255);return h};a=function(j,g){var h,f,p,k,r,w,t,x,z,A,B,C,D,y,E;j[g>>5]|=128<<24-g%32;j[(g+64>>9<<4)+15]=g;y=Array(80);h=1732584193;f=-271733879;p=-1732584194;k=271733878;r=-1009589776;w=0;for(E=j.length;w<E;w+=16){x=h;z=f;A=p;B=k;C=r;for(t=0;t<80;t++){y[t]=t<16?j[w+t]:b(y[t-3]^y[t-8]^y[t-14]^y[t-16],1);D=o(o(b(h,5),u(t,f,p,k)),o(o(r,y[t]),v(t)));r=k;k=p;p=b(f,30);f=h;h=D}h=o(h,x);f=o(f,z);p=o(p,
A);k=o(k,B);r=o(r,C)}return Array(h,f,p,k,r)};u=function(j,g,h,f){return j<20?g&h|~g&f:j<40?g^h^f:j<60?g&h|g&f|h&f:g^h^f};v=function(j){return j<20?1518500249:j<40?1859775393:j<60?-1894007588:-899497514};o=function(j,g){var h;h=(j&65535)+(g&65535);return(j>>16)+(g>>16)+(h>>16)<<16|h&65535};b=function(j,g){return j<<g|j>>>32-g};c.hex_sha1=function(j){return m(q(s(j)))};c.b64_sha1=function(j){return d(q(s(j)))};c.any_sha1=function(j,g){return e(q(s(j)),g)};c.hex_hmac_sha1=function(j,g){return m(n(s(j),
s(g)))};c.b64_hmac_sha1=function(j,g){return d(n(s(j),s(g)))};c.any_hmac_sha1=function(j,g,h){return e(n(s(j),s(g)),h)};return c}();var Storage;Storage=function(){var i;i={};i.get=function(a,b){var c;if(b==null)b=false;c=localStorage.getItem(a);if(b)c=JSON.parse(c);return c};i.set=function(a,b,c){if(c==null)c=false;if(c)b=JSON.stringify(b);localStorage.setItem(a,b);return b};i.del=function(a){return localStorage.removeItem(a)};return i}();var Settings;
Settings=function(){function i(a,b,c,e){this.access_key=a;this.secret_key=b;this.region=c!=null?c:"us-east-1";this.version=e!=null?e:"2009-04-15"}i.prototype.use_access_key=function(a){this.access_key=a;return this};i.prototype.use_secret_key=function(a){this.secret_key=a;return this};i.prototype.use_region=function(a){this.region=a;return this};i.prototype.use_version=function(a){this.version=a;return this};i.prototype.get_access_key=function(){return this.access_key};i.prototype.get_secret_key=
function(){return this.secret_key};i.prototype.get_region=function(){return this.region};i.prototype.get_version=function(){return this.version};i.prototype.to_json=function(){return{access_key:this.access_key,secret_key:this.secret_key,region:this.region,version:this.version}};i.from_json=function(a){return a?new i(a.access_key,a.secret_key,a.region,a.version):null};return i}();var AwsUtils;
AwsUtils=function(){var i,a,b,c,e;e=function(d){d=d.toString();if(d.length<2)d="0"+d;return d};c=function(d){return[d.getUTCFullYear(),e(d.getUTCMonth()+1),e(d.getUTCDate())].join("-")};i=function(d){return[e(d.getUTCHours()),e(d.getUTCMinutes()),e(d.getUTCSeconds())].join(":")};b=function(d,l){return d===l?0:d.toLowerCase()>l.toLowerCase()?1:-1};a={};a.date_time_format=function(d){if(d==null)d=new Date;return""+c(d)+"T"+i(d)+".000Z"};a.generate_sig=function(d,l){var m,n,q;n=function(){var o;o=[];
for(m in d)o.push(m);return o}();n.sort(b);q=function(){var o,u,v;v=[];o=0;for(u=n.length;o<u;o++){m=n[o];v.push(""+m+d[m])}return v}();return SHA1.b64_hmac_sha1(l,q.join(""))};return a}();var SimpleDB,__indexOf=Array.prototype.indexOf||function(i){for(var a=0,b=this.length;a<b;a++)if(this[a]===i)return a;return-1};
SimpleDB=function(){function i(a,b){this.profile=a;this.endpoint=b!=null?b:"sdb.amazonaws.com";this.sdb_base_url="http://"+this.endpoint+"?"}i.prototype.set_profile=function(a){return this.profile=a};i.prototype.default_callback=function(a){return console.log(a)};i.prototype.build_request_url=function(a,b){var c,e;b.Action=a;b.Timestamp=AwsUtils.date_time_format();b.AWSAccessKeyId=this.profile.get_settings().get_access_key();b.Version=this.profile.get_settings().get_version();b.SignatureVersion=1;
b.Signature=AwsUtils.generate_sig(b,this.profile.get_settings().get_secret_key());return this.sdb_base_url+function(){var d;d=[];for(c in b){e=b[c];d.push(c+"="+encodeURIComponent(e))}return d}().join("&")};i.parse_metadata=function(a,b,c){return{meta:{req_id:$("RequestId",a).text(),box_usage:parseFloat($("BoxUsage",a).text()),status:b,req_url:c}}};i.prototype.ajax_request=function(a,b,c,e){if(c==null)c="GET";if(e==null)e=b;return $.ajax({type:c,url:a,success:function(d,l){return b(i.parse_metadata(d,
l,a),d)},error:function(d,l){var m;m=i.parse_metadata(d.responseXML,l,a);m.error={msg:$("Message",d.responseXML).text(),code:$("Code",d.responseXML).text()};return e(m,d.responseXML)},dataType:"xml"})};i.prototype.list_domains=function(a,b,c){var e,d;if(a==null)a=this.default_callback;if(b==null)b=100;if(c==null)c=null;if(__indexOf.call(function(){d=[];for(e=1;e<=100;e++)d.push(e);return d}.apply(this),b)<0)throw"Max domains must be between 1 and 100";b={MaxNumberOfDomains:b};if(c)b.NextToken=c;return this.ajax_request(this.build_request_url("ListDomains",
b),function(l,m){var n;l.error!=null&&a(l);n=[];$("DomainName",m).each(function(){return n.push($(this).text())});l.domains=n;l.next_token=$("NextToken",m).text();return a(l)})};i.prototype.domain_metadata=function(a,b){if(b==null)b=this.default_callback;return this.ajax_request(this.build_request_url("DomainMetadata",{DomainName:a}),function(c,e){c.error!=null&&b(c);c.creation_date_time=$("CreationDateTime",e).text();c.item_count=parseInt($("ItemCount",e).text());c.item_names_size_bytes=parseInt($("ItemNamesSizeBytes",
e).text());c.attribute_name_count=parseInt($("AttributeNameCount",e).text());c.attribute_names_size_bytes=parseInt($("AttributeNamesSizeBytes",e).text());c.attribute_value_count=parseInt($("AttributeValueCount",e).text());c.attribute_values_size_bytes=parseInt($("AttributeValuesSizeBytes",e).text());c.timestamp=$("Timestamp",e).text();return b(c)})};i.prototype.select=function(a,b,c){if(b==null)b=this.default_callback;if(c==null)c=null;a={SelectExpression:a};if(c)a.NextToken=c;return this.ajax_request(this.build_request_url("Select",
a),function(e,d){var l;e.error!=null&&b(e);l=[];$("Item",d).each(function(){var m;m={attrs:{},name:$("Name:first",$(this)).text()};$("Attribute",$(this)).each(function(){var n,q;n=$("Name",$(this)).text();q=$("Value",$(this)).text();m.attrs[n]||(m.attrs[n]=[]);return m.attrs[n].push(q)});return l.push(m)});e.items=l;e.next_token=$("NextToken",d).text();return b(e)})};i.prototype.get_attributes=function(a,b,c,e){var d;if(c==null)c=this.default_callback;if(e==null)e=[];b={DomainName:a,ItemName:b};a=
0;for(d=e.length;0<=d?a<d:a>d;0<=d?a++:a--)b["AttributeName."+a]=e[a];return this.ajax_request(this.build_request_url("GetAttributes",b),function(l,m){var n;l.error!=null&&c(l);n={};$("Attribute",m).each(function(){var q,o;q=$("Name",$(this)).text();o=$("Value",$(this)).text();n[q]||(n[q]=[]);return n[q].push(o)});l.attributes=n;return c(l)})};i.prototype.put_attributes=function(a,b,c,e){var d,l,m,n,q,o,u;if(e==null)e=this.default_callback;l={DomainName:a,ItemName:b};n=b=0;for(o=c.length;n<o;n++){a=
c[n];d=a.values;q=0;for(u=d.length;q<u;q++){m=d[q];l["Attribute."+b+".Name"]=a.name;l["Attribute."+b+".Value"]=m;if(a.replace&&a.replace===true)l["Attribute."+b+".Replace"]=true;b+=1}}return this.ajax_request(this.build_request_url("PutAttributes",l),function(v){return e(v)})};i.prototype.delete_attributes=function(a,b,c,e){var d,l,m,n,q,o,u;if(e==null)e=this.default_callback;l={DomainName:a,ItemName:b};n=b=0;for(o=c.length;n<o;n++){a=c[n];if(d=a.values){q=0;for(u=d.length;q<u;q++){m=d[q];l["Attribute."+
b+".Name"]=a.name;l["Attribute."+b+".Value"]=m;b+=1}}else{l["Attribute."+b+".Name"]=a.name;b+=1}}return this.ajax_request(this.build_request_url("DeleteAttributes",l),function(v){return e(v)})};i.prototype.batch_delete_attributes=function(a,b,c){var e,d,l,m,n,q,o,u,v,s,j;if(c==null)c=this.default_callback;m={DomainName:a};a=0;for(s=b.length;0<=s?a<s:a>s;0<=s?a++:a--){e=b[a];d=e.item_name;m["Item."+a+".ItemName"]=d;d=0;j=e.item_attrs;q=0;for(u=j.length;q<u;q++){e=j[q];if(l=e.values){o=0;for(v=l.length;o<
v;o++){n=l[o];m["Item."+a+".Attribute."+d+".Name"]=e.name;m["Item."+a+".Attribute."+d+".Value"]=n;d+=1}}else{m["Item."+a+".Attribute."+d+".Name"]=e.name;d+=1}}}return this.ajax_request(this.build_request_url("BatchDeleteAttributes",m),function(g){return c(g)})};i.prototype.batch_put_attributes=function(a,b,c){var e,d,l,m,n,q,o,u,v,s,j;if(c==null)c=this.default_callback;m={DomainName:a};a=0;for(s=b.length;0<=s?a<s:a>s;0<=s?a++:a--){e=b[a];d=e.item_name;m["Item."+a+".ItemName"]=d;d=0;j=e.item_attrs;
q=0;for(u=j.length;q<u;q++){e=j[q];l=e.values;o=0;for(v=l.length;o<v;o++){n=l[o];m["Item."+a+".Attribute."+d+".Name"]=e.name;m["Item."+a+".Attribute."+d+".Value"]=n;if(e.replace&&e.replace===true)m["Item."+a+".Attribute."+d+".Replace"]=true;d+=1}}}return this.ajax_request(this.build_request_url("BatchPutAttributes",m),function(g){return c(g)})};i.prototype.create_domain=function(a,b){if(b==null)b=this.default_callback;return this.ajax_request(this.build_request_url("CreateDomain",{DomainName:a}),
function(c){return b(c)})};i.prototype.delete_domain=function(a,b){if(b==null)b=this.default_callback;return this.ajax_request(this.build_request_url("DeleteDomain",{DomainName:a}),function(c){return b(c)})};return i}();var Profile;
Profile=function(){function i(a,b){this.name=a;this.settings=b}i.prototype.use_name=function(a){this.name=a;return this};i.prototype.use_settings=function(a){this.settings=a;return this};i.prototype.get_name=function(){return this.name};i.prototype.get_settings=function(){return this.settings};i.prototype.make_primary=function(){Storage.set("chrome-sdb.primary-profile",this.name);return this};i.prototype.save=function(a){var b;if(a==null)a=false;b=i.find_all();b[this.name]=this.settings.to_json();
Storage.set("chrome-sdb.profiles",b,true);if(i.primary()===null||a)this.make_primary();return this};i.prototype["delete"]=function(){i["delete"](this.name);return null};i.prototype.to_json=function(){return{name:this.name,settings:this.settings.to_json()}};i.primary=function(){var a;a=Storage.get("chrome-sdb.primary-profile");return i.find(a)};i.from_json=function(a){return a?new i(a.name,Settings.from_json(a.settings)):null};i.find_all=function(){var a;return(a=Storage.get("chrome-sdb.profiles",
true))!=null?a:{}};i.find=function(a){var b,c,e;c=i.find_all();for(b in c){e=c[b];if(a===b)return new i(b,Settings.from_json(e))}return null};i["delete"]=function(a){var b;b=i.find_all();delete b[a];return Storage.set("chrome-sdb.profiles",b,true)};return i}();var handle_domains,profile,sdb;(profile=Profile.primary())||chrome.tabs.create({url:"config.html"});handle_domains=function(){};sdb=new SimpleDB(profile);
sdb.list_domains(function(i){var a,b,c,e;b=i.domains;e=function(){var d,l,m;m=[];d=0;for(l=b.length;d<l;d++){a=b[d];c='<a id="metadata_'+a+'" class="btn" href="#">Metadata</a>';m.push("<tr><td>"+a+"</td><td>"+c+"</td></tr>")}return m}();console.log(e);return $(function(){return $("#domains_table > tbody").html(e.join(""))})});})();
