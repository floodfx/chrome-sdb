(function(){var SHA1;
SHA1=function(){var b,a,c,d,f,e,k,n,p,o,l,s,u,r;d={};o=function(j){return b(a(k(j),j.length*8))};p=function(j,h){var i,g,q,m;i=k(j);if(i.length>16)i=a(i,j.length*8);q=Array(16);m=Array(16);for(g=0;g<16;g++){q[g]=i[g]^909522486;m[g]=i[g]^1549556828}i=a(q.concat(k(h)),512+h.length*8);return b(a(m.concat(i),672))};n=function(j,h){var i,g,q,m,t;if(h==null)h=true;i=h?"0123456789abcdef":"0123456789ABCDEF";q="";g=0;for(t=j.length;0<=t?g<t:g>t;0<=t?g++:g--){m=j.charCodeAt(g);q+=i.charAt(m>>>4&15)+i.charAt(m&
15)}return q};e=function(j,h){var i,g,q,m,t;if(h==null)h="=";m="";q=j.length;for(i=0;i<q;i+=3){t=j.charCodeAt(i)<<16|(i+1<q?j.charCodeAt(i+1)<<8:0)|(i+2<q?j.charCodeAt(i+2):0);for(g=0;g<4;g++)m+=i*8+g*6>j.length*8?h:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>6*(3-g)&63)}return m};f=function(j,h){var i,g,q,m,t,w,v,x;g=h.length;q=[];i=Array(Math.ceil(j.length/2));m=0;for(t=i.length;0<=t?m<t:m>t;0<=t?m++:m--)i[m]=j.charCodeAt(m*2)<<8|j.charCodeAt(m*2+1);for(;i.length>
0;){w=[];m=v=0;for(x=i.length;0<=x?m<x:m>x;0<=x?m++:m--){v=(v<<16)+i[m];t=Math.floor(v/g);v-=t*g;if(w.length>0||t>0)w[w.length]=t}q[q.length]=v;i=w}i="";for(m=g=q.length-1;g<=0?m<=0:m>=0;g<=0?m++:m--)i+=h.charAt(q[m]);q=Math.ceil(j.length*8/(Math.log(h.length)/Math.log(2)));for(m=g=i.length;g<=q?m<=q:m>=q;g<=q?m++:m--)i=h[0]+i;return i};r=function(j){var h,i,g,q,m;i="";h=0;for(m=j.length;0<=m?h<m:h>m;0<=m?h++:h--){g=j.charCodeAt(h);q=h+1<j.length?j.charCodeAt(h+1):0;if(55296<=g&&g<=56319&&56320<=
q&&q<=57343){g=65536+((g&1023)<<10)+(q&1023);h++}if(g<=127)i+=String.fromCharCode(g);else if(g<=2047)i+=String.fromCharCode(192|g>>>6&31,128|g&63);else if(g<=65535)i+=String.fromCharCode(224|g>>>12&15,128|g>>>6&63,128|g&63);else if(g<=2097151)i+=String.fromCharCode(240|g>>>18&7,128|g>>>12&63,128|g>>>6&63,128|g&63)}return i};k=function(j){var h,i,g;i=Array(j.length>>2);h=0;for(g=i.length;0<=g?h<g:h>g;0<=g?h++:h--)i[h]=0;h=0;for(g=j.length*8;h<g;h+=8)i[h>>5]|=(j.charCodeAt(h/8)&255)<<24-h%32;return i};
b=function(j){var h,i,g;i="";h=0;for(g=j.length*32;h<g;h+=8)i+=String.fromCharCode(j[h>>5]>>>24-h%32&255);return i};a=function(j,h){var i,g,q,m,t,w,v,x,z,A,B,C,D,y,E;j[h>>5]|=128<<24-h%32;j[(h+64>>9<<4)+15]=h;y=Array(80);i=1732584193;g=-271733879;q=-1732584194;m=271733878;t=-1009589776;w=0;for(E=j.length;w<E;w+=16){x=i;z=g;A=q;B=m;C=t;for(v=0;v<80;v++){y[v]=v<16?j[w+v]:c(y[v-3]^y[v-8]^y[v-14]^y[v-16],1);D=l(l(c(i,5),s(v,g,q,m)),l(l(t,y[v]),u(v)));t=m;m=q;q=c(g,30);g=i;i=D}i=l(i,x);g=l(g,z);q=l(q,
A);m=l(m,B);t=l(t,C)}return Array(i,g,q,m,t)};s=function(j,h,i,g){return j<20?h&i|~h&g:j<40?h^i^g:j<60?h&i|h&g|i&g:h^i^g};u=function(j){return j<20?1518500249:j<40?1859775393:j<60?-1894007588:-899497514};l=function(j,h){var i;i=(j&65535)+(h&65535);return(j>>16)+(h>>16)+(i>>16)<<16|i&65535};c=function(j,h){return j<<h|j>>>32-h};d.hex_sha1=function(j){return n(o(r(j)))};d.b64_sha1=function(j){return e(o(r(j)))};d.any_sha1=function(j,h){return f(o(r(j)),h)};d.hex_hmac_sha1=function(j,h){return n(p(r(j),
r(h)))};d.b64_hmac_sha1=function(j,h){return e(p(r(j),r(h)))};d.any_hmac_sha1=function(j,h,i){return f(p(r(j),r(h)),i)};return d}();var AwsUtils;
AwsUtils=function(){var b,a,c,d,f;f=function(e){e=e.toString();if(e.length<2)e="0"+e;return e};d=function(e){return[e.getUTCFullYear(),f(e.getUTCMonth()+1),f(e.getUTCDate())].join("-")};b=function(e){return[f(e.getUTCHours()),f(e.getUTCMinutes()),f(e.getUTCSeconds())].join(":")};c=function(e,k){return e===k?0:e.toLowerCase()>k.toLowerCase()?1:-1};a={};a.date_time_format=function(e){if(e==null)e=new Date;return""+d(e)+"T"+b(e)+".000Z"};a.generate_sig=function(e,k){var n,p,o;p=function(){var l;l=[];
for(n in e)l.push(n);return l}();p.sort(c);o=function(){var l,s,u;u=[];l=0;for(s=p.length;l<s;l++){n=p[l];u.push(""+n+e[n])}return u}();return SHA1.b64_hmac_sha1(k,o.join(""))};return a}();var SimpleDB,__indexOf=Array.prototype.indexOf||function(b){for(var a=0,c=this.length;a<c;a++)if(this[a]===b)return a;return-1};
SimpleDB=function(){function b(a,c,d){this.profile=a;this.secure=c!=null?c:false;this.error_callback=d!=null?d:this.default_callback;this.protocol=this.secure?"https":"http";this.endpoint=this.profile.get_settings().get_region();this.sdb_base_url=""+this.protocol+"://"+this.endpoint+"?"}b.prototype.set_profile=function(a){return this.profile=a};b.prototype.default_callback=function(a,c){if(c==null)c=null;console.log(a);if(c!==null)return console.log(c)};b.prototype.build_request_url=function(a,c){var d,
f;c.Action=a;c.Timestamp=AwsUtils.date_time_format();c.AWSAccessKeyId=this.profile.get_settings().get_access_key();c.Version=this.profile.get_settings().get_version();c.SignatureVersion=1;c.Signature=AwsUtils.generate_sig(c,this.profile.get_settings().get_secret_key());return this.sdb_base_url+function(){var e;e=[];for(d in c){f=c[d];e.push(d+"="+encodeURIComponent(f))}return e}().join("&")};b.regions=function(){return[{name:"US East (Northern Virginia) Region",endpoint:"sdb.amazonaws.com"},{name:"US West (Oregon) Region",
endpoint:"sdb.us-west-2.amazonaws.com"},{name:"US West (Northern California) Region",endpoint:"sdb.us-west-1.amazonaws.com"},{name:"EU (Ireland) Region",endpoint:"sdb.eu-west-1.amazonaws.com"},{name:"Asia Pacific (Singapore) Region",endpoint:"sdb.ap-southeast-1.amazonaws.com"},{name:"Asia Pacific (Tokyo) Region",endpoint:"sdb.ap-northeast-1.amazonaws.com"},{name:"South America (Sao Paulo) Region",endpoint:"sdb.sa-east-1.amazonaws.com"}]};b.parse_metadata=function(a,c,d){return{meta:{req_id:$("RequestId",
a).text(),box_usage:parseFloat($("BoxUsage",a).text()),status:c,req_url:d}}};b.prototype.ajax_request=function(a,c,d,f){if(d==null)d="GET";if(f==null)f=this.error_callback;return $.ajax({type:d,url:a,success:function(e,k){return c(b.parse_metadata(e,k,a),e)},error:function(e,k){var n;n=b.parse_metadata(e.responseXML,k,a);n.error={msg:$("Message",e.responseXML).text(),code:$("Code",e.responseXML).text()};return f(n,e.responseXML)},dataType:"xml"})};b.prototype.list_domains=function(a,c,d){var f,e;
if(a==null)a=this.default_callback;if(c==null)c=100;if(d==null)d=null;if(__indexOf.call(function(){e=[];for(f=1;f<=100;f++)e.push(f);return e}.apply(this),c)<0)throw"Max domains must be between 1 and 100";c={MaxNumberOfDomains:c};if(d)c.NextToken=d;return this.ajax_request(this.build_request_url("ListDomains",c),function(k,n){var p;p=[];$("DomainName",n).each(function(){return p.push($(this).text())});k.domains=p;k.next_token=$("NextToken",n).text();return a(k)})};b.prototype.domain_metadata=function(a,
c){if(c==null)c=this.default_callback;return this.ajax_request(this.build_request_url("DomainMetadata",{DomainName:a}),function(d,f){d.creation_date_time=$("CreationDateTime",f).text();d.item_count=parseInt($("ItemCount",f).text());d.item_names_size_bytes=parseInt($("ItemNamesSizeBytes",f).text());d.attribute_name_count=parseInt($("AttributeNameCount",f).text());d.attribute_names_size_bytes=parseInt($("AttributeNamesSizeBytes",f).text());d.attribute_value_count=parseInt($("AttributeValueCount",f).text());
d.attribute_values_size_bytes=parseInt($("AttributeValuesSizeBytes",f).text());d.timestamp=$("Timestamp",f).text();return c(d)})};b.prototype.select=function(a,c,d){if(c==null)c=this.default_callback;if(d==null)d=null;a={SelectExpression:a};if(d)a.NextToken=d;return this.ajax_request(this.build_request_url("Select",a),function(f,e){var k,n,p;p=[];n={};$("Item",e).each(function(){var o;o={attrs:{},name:$("Name:first",$(this)).text()};$("Attribute",$(this)).each(function(){var l,s;l=$("Name",$(this)).text();
n[l]=l;s=$("Value",$(this)).text();o.attrs[l]||(o.attrs[l]=[]);return o.attrs[l].push(s)});return p.push(o)});f.items=p;f.attr_names=function(){var o;o=[];for(k in n)o.push(k);return o}();d=$("NextToken",e).text();if(d!=="")f.next_token=d;return c(f)})};b.prototype.get_attributes=function(a,c,d,f){var e;if(d==null)d=this.default_callback;if(f==null)f=[];c={DomainName:a,ItemName:c};a=0;for(e=f.length;0<=e?a<e:a>e;0<=e?a++:a--)c["AttributeName."+a]=f[a];return this.ajax_request(this.build_request_url("GetAttributes",
c),function(k,n){var p;k.error!=null&&d(k);p={};$("Attribute",n).each(function(){var o,l;o=$("Name",$(this)).text();l=$("Value",$(this)).text();p[o]||(p[o]=[]);return p[o].push(l)});k.attributes=p;return d(k)})};b.prototype.put_attributes=function(a,c,d,f){var e,k,n,p,o,l,s;if(f==null)f=this.default_callback;k={DomainName:a,ItemName:c};p=c=0;for(l=d.length;p<l;p++){a=d[p];e=a.values;o=0;for(s=e.length;o<s;o++){n=e[o];k["Attribute."+c+".Name"]=a.name;k["Attribute."+c+".Value"]=n;if(a.replace&&a.replace===
true)k["Attribute."+c+".Replace"]=true;c+=1}}return this.ajax_request(this.build_request_url("PutAttributes",k),function(u){return f(u)})};b.prototype.delete_attributes=function(a,c,d,f){var e,k,n,p,o,l,s;if(f==null)f=this.default_callback;k={DomainName:a,ItemName:c};p=c=0;for(l=d.length;p<l;p++){a=d[p];if(e=a.values){o=0;for(s=e.length;o<s;o++){n=e[o];k["Attribute."+c+".Name"]=a.name;k["Attribute."+c+".Value"]=n;c+=1}}else{k["Attribute."+c+".Name"]=a.name;c+=1}}return this.ajax_request(this.build_request_url("DeleteAttributes",
k),function(u){return f(u)})};b.prototype.batch_delete_attributes=function(a,c,d){var f,e,k,n,p,o,l,s,u,r,j;if(d==null)d=this.default_callback;n={DomainName:a};a=0;for(r=c.length;0<=r?a<r:a>r;0<=r?a++:a--){f=c[a];e=f.item_name;n["Item."+a+".ItemName"]=e;e=0;j=f.item_attrs;o=0;for(s=j.length;o<s;o++){f=j[o];if(k=f.values){l=0;for(u=k.length;l<u;l++){p=k[l];n["Item."+a+".Attribute."+e+".Name"]=f.name;n["Item."+a+".Attribute."+e+".Value"]=p;e+=1}}else{n["Item."+a+".Attribute."+e+".Name"]=f.name;e+=1}}}return this.ajax_request(this.build_request_url("BatchDeleteAttributes",
n),function(h){return d(h)})};b.prototype.batch_put_attributes=function(a,c,d){var f,e,k,n,p,o,l,s,u,r,j;if(d==null)d=this.default_callback;n={DomainName:a};a=0;for(r=c.length;0<=r?a<r:a>r;0<=r?a++:a--){f=c[a];e=f.item_name;n["Item."+a+".ItemName"]=e;e=0;j=f.item_attrs;o=0;for(s=j.length;o<s;o++){f=j[o];k=f.values;l=0;for(u=k.length;l<u;l++){p=k[l];n["Item."+a+".Attribute."+e+".Name"]=f.name;n["Item."+a+".Attribute."+e+".Value"]=p;if(f.replace&&f.replace===true)n["Item."+a+".Attribute."+e+".Replace"]=
true;e+=1}}}return this.ajax_request(this.build_request_url("BatchPutAttributes",n),function(h){return d(h)})};b.prototype.create_domain=function(a,c){if(c==null)c=this.default_callback;return this.ajax_request(this.build_request_url("CreateDomain",{DomainName:a}),function(d){return c(d)})};b.prototype.delete_domain=function(a,c){if(c==null)c=this.default_callback;return this.ajax_request(this.build_request_url("DeleteDomain",{DomainName:a}),function(d){return c(d)})};return b}();var Storage;
Storage=function(){var b;b={};b.get=function(a,c){var d;if(c==null)c=false;d=localStorage.getItem(a);if(c)d=JSON.parse(d);return d};b.set=function(a,c,d){if(d==null)d=false;if(d)c=JSON.stringify(c);localStorage.setItem(a,c);return c};b.del=function(a){return localStorage.removeItem(a)};return b}();var Settings;
Settings=function(){function b(a,c,d,f,e){this.access_key=a;this.secret_key=c;this.region=d!=null?d:"sdb.amazonaws.com";this.version=f!=null?f:"2009-04-15";this.https_protocol=e!=null?e:false}b.prototype.use_access_key=function(a){this.access_key=a;return this};b.prototype.use_secret_key=function(a){this.secret_key=a;return this};b.prototype.use_region=function(a){this.region=a;return this};b.prototype.use_version=function(a){this.version=a;return this};b.prototype.use_https_protocol=function(a){this.https_protocol=
a;return this};b.prototype.get_access_key=function(){return this.access_key};b.prototype.get_secret_key=function(){return this.secret_key};b.prototype.get_region=function(){return this.region};b.prototype.get_version=function(){return this.version};b.prototype.get_use_https=function(){return this.https_protocol};b.prototype.to_json=function(){return{access_key:this.access_key,secret_key:this.secret_key,region:this.region,version:this.version,https_protocol:this.https_protocol}};b.from_json=function(a){return a?
new b(a.access_key,a.secret_key,a.region,a.version,a.https_protocol):null};return b}();var Profile;
Profile=function(){function b(a,c){this.name=a;this.settings=c}b.prototype.use_name=function(a){this.name=a;return this};b.prototype.use_settings=function(a){this.settings=a;return this};b.prototype.get_name=function(){return this.name};b.prototype.get_settings=function(){return this.settings};b.prototype.make_primary=function(){Storage.set("chrome-sdb.primary-profile",this.name);return this};b.prototype.save=function(a){var c,d,f,e,k;if(a==null)a=false;f=b.find_all();c=false;e=0;for(k=f.length;e<
k;e++){d=f[e];if(this.name===d.get_name()){d.use_settings(this.settings);c=true}}c||f.push(this);Storage.set("chrome-sdb.profiles",b.profiles_json(f),true);if(b.primary()===null||a)this.make_primary();return this};b.prototype["delete"]=function(){b["delete"](this.name);return null};b.prototype.to_json=function(){return{name:this.name,settings:this.settings.to_json()}};b.primary=function(){var a;a=Storage.get("chrome-sdb.primary-profile");return b.find(a)};b.from_json=function(a){return a?new b(a.name,
Settings.from_json(a.settings)):null};b.find_all=function(){var a,c,d,f;c=(f=Storage.get("chrome-sdb.profiles",true))!=null?f:{};return function(){var e;e=[];for(a in c){d=c[a];e.push(new b(a,Settings.from_json(d)))}return e}()};b.find=function(a){var c,d,f,e;d=b.find_all();f=0;for(e=d.length;f<e;f++){c=d[f];if(c.get_name()===a)return c}return null};b.profiles_json=function(a){var c,d,f,e;d={};f=0;for(e=a.length;f<e;f++){c=a[f];d[c.get_name()]=c.get_settings().to_json()}return d};b.delete_all=function(){return Storage.set("chrome-sdb.profiles",
{},true)};b["delete"]=function(a){var c,d,f,e;f=b.find_all();d=[];c=0;for(e=f.length;0<=e?c<e:c>e;0<=e?c++:c--)f[c].get_name()!==a&&d.push(f[c]);return Storage.set("chrome-sdb.profiles",b.profiles_json(d),true)};return b}();var add_domains,add_item,confirm_delete,confirm_delete_item,delete_domain,delete_item,disable_delete,domain_from_query,edit_item,enable_delete,handle_delete_toggle,handle_error,handle_query,metadata,profile,query,save_domain,save_item,sdb,update_domains_table,update_region;
profile=Profile.primary();handle_error=function(b){var a,c;a=b.error.code;c=b.error.msg;b=b.meta.req_url;$("#error_code").text(a);$("#error_msg").text(c);$("#error_url").attr("href",b);$("#message_box").show();return $("#query_btn").button("reset")};if(profile){sdb=new SimpleDB(profile,false,handle_error);$(function(){return update_domains_table()})}else window.location="config.html";
update_region=function(b){profile.get_settings().use_region(b);profile.save();sdb=new SimpleDB(profile,false,handle_error);return update_domains_table()};
$(function(){var b,a,c,d;d=SimpleDB.regions();a=0;for(c=d.length;a<c;a++){b=d[a];$("#region_select").append($("<option>",{value:b.endpoint}).text(b.name))}$("#region_select").val(profile.get_settings().get_region());$("#region_select").change(function(){b=$("#region_select").val();return update_region(b)});$("#domain_table_div").height($(window).height()-200);$(window).resize(function(){return $("#domain_table_div").height($(this).height()-200)});$("#query_btn").click(function(){return query()});
$("#add_item").click(function(){return add_item()});$("#domain_deletion_control").click(function(){return handle_delete_toggle()});$("#save_attribute_btn").click(function(){return save_item()});$("#save_domain").click(function(){return save_domain()});$("#save_domain_cancel").click(function(){return $("#create_domain_modal").modal("hide")});$("#reset_attribute_btn_cancel").click(function(){return $("#add_edit_item_attributes").modal("hide")});$("#confirm_delete_domain_btn_cancel").click(function(){return $("#confirm_delete_domain_modal").modal("hide")});
$("#metadata_btn_ok").click(function(){return $("#domain_metadata_modal").modal("hide")});$(".msg_box_close").click(function(){return $("#message_box").hide()});$("#delete_item_btn_yes").click(function(){return delete_item()});$("#delete_item_btn_cancel").click(function(){return $("#item_delete_modal").hide()});return $("input[name=confirm_delete]").keydown(function(f){return $("input[name=confirm_delete]").val()==="DELET"&&f.keyCode===69?$("#confirm_delete_domain_btn").removeAttr("disabled").addClass("danger").removeClass("secondary"):
$("#confirm_delete_domain_btn").attr("disabled","disabled").addClass("secondary").removeClass("danger")})});
add_domains=function(b){var a,c,d,f,e,k;if(b.length===0){a="<tr><td>No domains in this region</td></tr>";return $("#domains_table > tbody").html(a)}else{$("#domains_table > tbody").html("");e=0;for(k=b.length;e<k;e++){d=b[e];c=$('<button id="metadata_'+d+'" class="btn info">metadata</a>');c.click(function(){return metadata(d)});a=$('<button id="delete_'+d+'" class="btn" disabled="disabled" style="margin-left:5px">delete</button>');a.click(function(){return confirm_delete(d)});f=$('<a href="#">'+d+
"</a>").click(function(){var n;n=$(this).html();return $("#query_expr").val("select * from `"+n+"`")});a=$("<td></td>").append(f).append("<br />").append(c).append(a);a=$("<tr></tr>").append(a);$("#domains_table > tbody").append(a)}$("#domain_select > option").remove();a=[];e=0;for(k=b.length;e<k;e++){d=b[e];a.push($("#domain_select").append($("<option>",{value:d}).text(d)))}return a}};
update_domains_table=function(b){if(b==null)b=null;return sdb.list_domains(function(a){add_domains(a.domains);if(b!=null)return b()})};add_item=function(){$("#domain_select").val(domain_from_query());$("#item_name").val("");$("#attr_name").val("");$("#attr_value_textarea").val("");$("#attr_value_is_multivalued").removeAttr("checked");return $("#add_edit_item_label").text("Add Item")};
edit_item=function(b,a,c,d){$("#domain_select").val(b);$("#item_name").val(a);$("#attr_name").val(c);$("#attr_value_textarea").val(d.join("\n")).attr("rows",Math.max(1,d.length));d.length>1?$("#attr_value_is_multivalued").attr("checked","checked"):$("#attr_value_is_multivalued").removeAttr("checked");$("#add_edit_item_label").text("Edit Item");return $("#add_edit_item_attributes").modal("show")};
save_item=function(){var b,a,c,d,f,e,k;e=$("#domain_select").val();k=$("#item_name").val();c=$("#attr_name").val();f=$("#attr_value_textarea").val();d=$("#attr_replace").is(":checked");b=$("#attr_value_is_multivalued").is(":checked");a=$("#attr_value_delimiter").val();b=b?f.split(RegExp(a)):[f];return sdb.put_attributes(e,k,[{name:c,values:b,replace:d}],function(){return $("#add_edit_item_attributes").modal("hide")})};
enable_delete=function(){$("button[id^=delete_]").removeAttr("disabled").addClass("danger").removeClass("secondary");return $("#domain_deletion_control").text("Disable Delete").addClass("danger").removeClass("secondary").addClass("active")};disable_delete=function(){$("button[id^=delete_]").attr("disabled","disabled").addClass("secondary").removeClass("danger");return $("#domain_deletion_control").text("Enable Delete").addClass("secondary").removeClass("danger").removeClass("active")};
handle_delete_toggle=function(){return $("#domain_deletion_control").hasClass("active")?disable_delete():enable_delete()};domain_from_query=function(){var b;b=$("#query_expr").val().match(/\`(.+)\`/);return b!==null?b[1]:null};
handle_query=function(b){var a,c,d,f,e,k,n,p,o;$("#message_box").hide();e=b.items.length;k=b.next_token;if(k!=null){k=k.replace(/\n/g,"");$("#next_page_btn").removeAttr("disabled").click(function(){return query(k)})}else $("#next_page_btn").attr("disabled","disabled").unbind("click");if(e===0){$("#query_results_table > thead").html("<tr><th>Items</th></tr>");$("#query_results_table > tbody").html("<tr><td>No results...</td></tr>")}else{e=function(){var l,s,u,r;u=b.attr_names;r=[];l=0;for(s=u.length;l<
s;l++){a=u[l];r.push("<th>"+a+"</th>")}return r}();$("#query_results_table > thead").html("<tr><th></th><th>Item Name</th>"+e.join("")+"</tr>");$("#query_results_table > tbody").html("");o=b.items;e=0;for(p=o.length;e<p;e++){f=o[e];n=function(){var l,s,u,r;u=b.attr_names;r=[];l=0;for(s=u.length;l<s;l++){a=u[l];c=f.attrs[a];r.push(c!=null?c.length>1?'<td data-attr-name="'+a+'" data-attr-multivalued="true"><table class="multivalued"><tbody><tr><td>'+c.join("</td></tr><tr><td>")+"</td></tr></tbody></table></td>":
'<td data-attr-name="'+a+'" data-attr-multivalued="false">'+c.join("")+"</td>":'<td data-attr-name="'+a+'" data-attr-multivalued="false"></td>')}return r}();d=$('<td class="delete">x</td>').click(function(){return confirm_delete_item($(this).closest("tr").attr("data-item-name"))});d=$("<tr></tr>").attr("data-item-name",f.name).append(d).append("<td>"+f.name+"</td>").append(n.join(""));$("#query_results_table > tbody").append(d)}$("#query_results_table > tbody > tr").each(function(l,s){return $(s).children("td").each(function(u,
r){var j,h;if(u>1){j=function(){return $(this).addClass("edititem").dblclick(function(){var i,g,q;g=$(this).parent().attr("data-item-name");a=$(this).attr("data-attr-name");i=$(this).attr("data-attr-multivalued")==="true";q=[];i?$(this).children("table").children("tbody").children("tr").children("td").each(function(m,t){return q.push($(t).text())}):q.push($(this).text());return edit_item(domain_from_query(),g,a,q)})};h=function(){return $(this).removeClass("edititem")};return $(r).hover(j,h)}})})}return $("#query_btn").button("reset")};
query=function(b){var a;if(b==null)b=null;a=$("#query_expr").val();sdb.select(a,handle_query,b);return $("#query_btn").button("loading")};
metadata=function(b){return sdb.domain_metadata(b,function(a){$("#domain_metadata_label").html("<h2>"+b+" <small>Metadata</small></h2>");$("input[name=itemCount]").val(a.item_count);$("input[name=itemNamesSizeBytes]").val(a.item_names_size_bytes);$("input[name=attributeNameCount]").val(a.attribute_name_count);$("input[name=attributeNamesSizeBytes]").val(a.attribute_names_size_bytes);$("input[name=attributeValueCount]").val(a.attribute_value_count);$("input[name=attributeValuesSizeBytes]").val(a.attribute_values_size_bytes);
return $("#domain_metadata_modal").modal("show")})};confirm_delete_item=function(b){$("#item_delete_modal").find('input[name="domain_name"]').val(domain_from_query());$("#item_delete_modal").find('input[name="item_name"]').val(b);return $("#item_delete_modal").modal("show")};
delete_item=function(){var b,a;b=$("#item_delete_modal").find('input[name="domain_name"]').val();a=$("#item_delete_modal").find('input[name="item_name"]').val();return sdb.delete_attributes(b,a,{},function(){$("#query_results_table").find('*[data-item-name="'+a+'"]').remove();return $("#item_delete_modal").hide()})};confirm_delete=function(b){$("#domain_delete_label").html("<h2>Delete "+b+"?</h2>");$("input[name=confirm_delete]").val("");$("#confirm_delete_domain_modal").modal("show");return $("#confirm_delete_domain_btn").click(function(){return delete_domain(b)})};
delete_domain=function(b){$("#confirm_delete_domain_btn").button("loading");return sdb.delete_domain(b,function(){$("#confirm_delete_domain_btn").button("reset");return update_domains_table(function(){disable_delete();return $("#confirm_delete_domain_modal").modal("hide")})})};save_domain=function(){var b;b=$("#domain_name").val();$("#save_domain").button("loading");return sdb.create_domain(b,function(){return update_domains_table(function(){$("#save_domain").button("reset");return $("#create_domain_modal").modal("hide")})})};
var add_sample_domain,finish_tour,optional_add_domain,sample_query,sample_query_results;add_sample_domain=function(){if($("#domain_select > option").length<1)return add_domains(["example_domain_chrome_sdb"])};optional_add_domain=function(){add_sample_domain();return guiders.next()};sample_query=function(){var b;b=$($("#domain_select > option")[0]).text();$("#query_expr").val("select * from `"+b+"`");return guiders.next()};
sample_query_results=function(){handle_query({items:[{name:"item name",attrs:{"single value attribute":["attribute value"],"multivalued attribute":["val A","val B"]}}],attr_names:["single value attribute","multivalued attribute"]});return guiders.next()};finish_tour=function(){handle_query({items:[],attr_names:[]});$("#query_expr").val("");update_domains_table();Storage.set("chrome-sdb-intro","true");return guiders.hideAll()};
$(function(){if(Storage.get("chrome-sdb-intro")===null){guiders.createGuider({buttons:[{name:"Next",onclick:optional_add_domain}],description:"This is the Query page in the Chrome Simple DB Tool.  This page is where you add and edit Items and Query your Simple DB domains.",id:"first",next:"second",overlay:true,title:"Chrome Simple DB Tool: Query Page"}).show();guiders.createGuider({attachTo:"#domains_table",buttons:[{name:"Next"}],description:"The domains table shows all the Simple DB domains in the selected Amazon Web Services Region.",
id:"second",next:"third",position:2,title:"Domains Table",width:450,offset:{top:-30,left:0}});guiders.createGuider({attachTo:"#region_select",buttons:[{name:"Next"}],description:"The Region selector allows you to change the region that you are querying.  It updates the Domain table automatically.",id:"third",next:"forth",position:2,title:"Regions Select",width:450,offset:{top:-30,left:0}});guiders.createGuider({attachTo:"#create_domain",buttons:[{name:"Next"}],description:'If you need to add another domain, use the "Create Domain" button.',
id:"forth",next:"fifth",position:2,title:"Create Domain",width:450,offset:{top:-30,left:0}});guiders.createGuider({attachTo:"#domain_deletion_control",buttons:[{name:"Next"}],description:"This button toggles domain deletion enablement.",id:"fifth",next:"sixth",position:2,title:"Delete Domain Control",width:450,offset:{top:-30,left:0}});guiders.createGuider({attachTo:"#query_expr",buttons:[{name:"Next",onclick:sample_query}],description:'Enter domain select expressions in the query box.  Don\'t forget to enclose your domain in backticks ("`") in the query',
id:"sixth",next:"seven",position:6,title:"Query your domains",width:450,offset:{top:-30,left:0}});guiders.createGuider({attachTo:"#query_results_table",buttons:[{name:"Next",onclick:sample_query_results}],description:"Query results show up in the in the table below.",id:"seven",next:"eight",position:12,title:"Query results",width:450,offset:{top:-30,left:0}});guiders.createGuider({attachTo:"#query_results_table",buttons:[{name:"Next"}],description:"Scroll over an attribute and click on it to edit.",
id:"eight",next:"ninth",position:6,title:"Edit attributes",width:450,offset:{top:-30,left:0}});return guiders.createGuider({buttons:[{name:"Close",onclick:finish_tour}],description:"That's it!  Please submit feedback and bugs and enjoy.",id:"ninth",overlay:true,title:"Cool? Cool..."})}});})();
